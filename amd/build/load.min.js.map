{"version":3,"sources":["../src/load.js"],"names":["define","Ajax","EvokeFeed","blockdiv","document","querySelector","loaditems","addEventListener","event","scrollTop","target","scrollHeight","offsetHeight","hasmoreitems","dataset","wait","bind","prototype","containerelement","courseid","parseInt","limitcomments","limitlikes","limitskilpoints","limitevocoins","limitbadges","request","call","methodname","args","done","response","loadingdiv","classList","add","data","JSON","parse","ulelement","items","forEach","element","url","replace","listitem","createElement","className","href","innerHTML","icon","text","appendChild"],"mappings":"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","sourcesContent":["/**\n * Add comment js logic.\n *\n * @package    mod_evokeportfolio\n * @copyright  2021 World Bank Group <https://worldbank.org>\n * @author     Willian Mano <willianmanoaraujo@gmail.com>\n */\n\n/* eslint-disable */\ndefine(['core/ajax'], function(Ajax) {\n    var EvokeFeed = function() {\n        var blockdiv = document.querySelector('.block-evokefeed');\n\n        this.loaditems();\n\n        blockdiv.addEventListener(\"scroll\", function(event) {\n            var scrollTop = event.target.scrollTop;\n            var scrollHeight = event.target.scrollHeight;\n            var offsetHeight = event.target.offsetHeight;\n\n            var hasmoreitems = event.target.dataset.hasmoreitems === 'true';\n\n            if(scrollTop + offsetHeight > scrollHeight - 40) {\n                if (!hasmoreitems) {\n                    return;\n                }\n\n                if (!this.wait) {\n                    this.loaditems();\n                }\n            }\n        }.bind(this), false);\n    };\n\n    EvokeFeed.prototype.wait = false;\n\n    EvokeFeed.prototype.loaditems = function() {\n        this.wait = true;\n\n        var containerelement = document.querySelector('.block-evokefeed');\n\n        var courseid = parseInt(containerelement.dataset.courseid);\n        var limitcomments = parseInt(containerelement.dataset.limitcomments);\n        var limitlikes = parseInt(containerelement.dataset.limitlikes);\n        var limitskilpoints = parseInt(containerelement.dataset.limitskilpoints);\n        var limitevocoins = parseInt(containerelement.dataset.limitevocoins);\n        var limitbadges = parseInt(containerelement.dataset.limitbadges);\n        var hasmoreitems = containerelement.dataset.hasmoreitems === 'true';\n\n        var request = Ajax.call([{\n            methodname: 'block_evokefeed_load',\n            args: {\n                courseid: courseid,\n                limitcomments: limitcomments,\n                limitlikes: limitlikes,\n                limitskilpoints: limitskilpoints,\n                limitevocoins: limitevocoins,\n                limitbadges: limitbadges,\n                hasmoreitems: hasmoreitems\n            }\n        }]);\n\n        request[0].done(function(response) {\n            var loadingdiv = document.querySelector('.block_evokefeed .loading-placeholder');\n\n            loadingdiv.classList.add('hidden');\n\n            var data = JSON.parse(response.data);\n\n            containerelement.dataset.limitcomments = limitcomments + 1;\n            containerelement.dataset.limitlikes = limitlikes + 1;\n            containerelement.dataset.limitskilpoints = limitskilpoints + 1;\n            containerelement.dataset.limitevocoins = limitevocoins + 1;\n            containerelement.dataset.limitbadges = limitbadges + 1;\n            containerelement.dataset.hasmoreitems = data.hasmoreitems;\n\n            var ulelement = document.querySelector('.block-evokefeed .list-group');\n\n            data.items.forEach(function(element) {\n                var url = element.url;\n                url = url.replace(/&amp;/g, \"&\");\n\n                var listitem = document.createElement('a');\n                listitem.className = 'list-group-item list-group-item-action fadein';\n                listitem.href = url;\n                listitem.innerHTML = '<i class=\"fa '+element.icon+'\"></i> ' + element.text;\n\n                ulelement.appendChild(listitem);\n            });\n\n            this.wait = false;\n        }.bind(this));\n    }\n\n    return {\n        'init': function() {\n            return new EvokeFeed();\n        }\n    };\n});\n"],"file":"load.min.js"}